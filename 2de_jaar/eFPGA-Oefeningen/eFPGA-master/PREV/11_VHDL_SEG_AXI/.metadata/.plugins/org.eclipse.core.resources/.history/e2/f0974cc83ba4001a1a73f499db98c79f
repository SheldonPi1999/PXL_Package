#include <stdio.h>
#include "platform.h"
#include "xil_printf.h"
#include "sleep.h"
#include "xparameters.h"
#include "xgpiops.h"
#include "xgpio.h"

#define MASK 0b11111111
#define CHANNEL_PL 1

#define GPIO_DEVICE_ID_PL XPAR_AXI_GPIO_0_DEVICE_ID

XGpio Gpio;
void testfunctionPL(XGpio *gpio, int digit);

int main()
{
	int Status;
	int digit = 0;

    init_platform();

    Status = XGpio_Initialize(&Gpio, GPIO_DEVICE_ID_PL);

	if (Status != XST_SUCCESS) {
		xil_printf("GpioPl Initialization Failed\r\n");
		return XST_FAILURE;
	}

	XGpio_SetDataDirection(&Gpio, CHANNEL_PL, MASK);

    print("GPIO PS and PL Demo Application!\n\r");


    while(1)
    {
    	testfunctionPL(&Gpio, digit);
    	sleep_A9(1);
    	digit++;
    }

    cleanup_platform();
    return 0;
}

void testfunctionPL(XGpio *gpio, int digit)
{
	int zero = 0b00111111;
	switch(digit)
	{
		case 0:
		{
			XGpio_DiscreteWrite(&Gpio, CHANNEL_PL, zero);
			sleep_A9(1);
		}
		case 1:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b00000110");
			sleep_A9(1);
		}

		case 2:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01011011");
			sleep_A9(1);
		}

		case 3:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01001111");
			sleep_A9(1);
		}

		case 4:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01100110");
			sleep_A9(1);
		}

		case 5:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01101101");
			sleep_A9(1);
		}

		case 6:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01111101");
			sleep_A9(1);
		}

		case 7:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b00000111");
			sleep_A9(1);
		}

		case 8:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01111111");
			sleep_A9(1);
		}

		case 9:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01101111");
			sleep_A9(1);
		}

		case 10:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01110111");
			sleep_A9(1);
		}

		case 11:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01111100");
			sleep_A9(1);
		}

		case 12:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b00111001");
			sleep_A9(1);
		}

		case 13:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01011110");
			sleep_A9(1);
		}

		case 14:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01111001");
			sleep_A9(1);
		}

		case 15:
		{
			XGpio_DiscreteWrite(&Gpio,CHANNEL_PL, "0b01110001");
			sleep_A9(1);
		}
	}
}
